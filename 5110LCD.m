#include "5110LCD.h"
#include "nrf_delay.h"

void delay_ms(int t)
{
	nrf_delay_ms(t);
}
  
 
  //------------GPIO口设置----------------------------
  void GPIO_Configuration_LCD(void)
{
	nrf_gpio_port_dir_set(NRF_GPIO_PORT_SELECT_PORT2, NRF_GPIO_PORT_DIR_OUTPUT);
 
   
	//-----------配置各端口的高低电平------------//
	nrf_gpio_pin_set(P_BL);

}
 //----------------------------------英文字符库-------------------------------------
// 6 x 8 font
// 1 pixel space at left and bottom
// 位置 = (ASCII - 32)*6
//----------------------------------------------------------------------------------
//****************************************************************************************************
// 	英文字符大小
//****************************************************************************************************
#define WIDTH    6
#define HEIGHT   8
//****************************************************************************************************
// 中文字符大小
//****************************************************************************************************
#define WIDTH_CN	13
#define HEIGHT_CN	16
 
unsigned char lcd_display[]="0123456789";  

const unsigned char font[][6] =
{
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },   // sp
	{ 0x00, 0x00, 0x00, 0x2f, 0x00, 0x00 },   // !
	{ 0x00, 0x00, 0x07, 0x00, 0x07, 0x00 },   // "
	{ 0x00, 0x14, 0x7f, 0x14, 0x7f, 0x14 },   // #
	{ 0x00, 0x24, 0x2a, 0x7f, 0x2a, 0x12 },   // $
	{ 0x00, 0x62, 0x64, 0x08, 0x13, 0x23 },   // %
	{ 0x00, 0x36, 0x49, 0x55, 0x22, 0x50 },   // &
	{ 0x00, 0x00, 0x05, 0x03, 0x00, 0x00 },   // '
	{ 0x00, 0x00, 0x1c, 0x22, 0x41, 0x00 },   // (
	{ 0x00, 0x00, 0x41, 0x22, 0x1c, 0x00 },   // )
	{ 0x00, 0x14, 0x08, 0x3E, 0x08, 0x14 },   // *
	{ 0x00, 0x08, 0x08, 0x3E, 0x08, 0x08 },   // +
	{ 0x00, 0x00, 0x00, 0xA0, 0x60, 0x00 },   // ,
	{ 0x00, 0x08, 0x08, 0x08, 0x08, 0x08 },   // -
	{ 0x00, 0x00, 0x60, 0x60, 0x00, 0x00 },   // .
	{ 0x00, 0x20, 0x10, 0x08, 0x04, 0x02 },   // /
	{ 0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E },   // 0
	{ 0x00, 0x00, 0x42, 0x7F, 0x40, 0x00 },   // 1
	{ 0x00, 0x42, 0x61, 0x51, 0x49, 0x46 },   // 2
	{ 0x00, 0x21, 0x41, 0x45, 0x4B, 0x31 },   // 3
	{ 0x00, 0x18, 0x14, 0x12, 0x7F, 0x10 },   // 4
	{ 0x00, 0x27, 0x45, 0x45, 0x45, 0x39 },   // 5
	{ 0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30 },   // 6
	{ 0x00, 0x01, 0x71, 0x09, 0x05, 0x03 },   // 7
	{ 0x00, 0x36, 0x49, 0x49, 0x49, 0x36 },   // 8
	{ 0x00, 0x06, 0x49, 0x49, 0x29, 0x1E },   // 9
	{ 0x00, 0x00, 0x36, 0x36, 0x00, 0x00 },   // :
	{ 0x00, 0x00, 0x56, 0x36, 0x00, 0x00 },   // ;
	{ 0x00, 0x08, 0x14, 0x22, 0x41, 0x00 },   // <
	{ 0x00, 0x14, 0x14, 0x14, 0x14, 0x14 },   // =
	{ 0x00, 0x00, 0x41, 0x22, 0x14, 0x08 },   // >
	{ 0x00, 0x02, 0x01, 0x51, 0x09, 0x06 },   // ?
	{ 0x00, 0x32, 0x49, 0x59, 0x51, 0x3E },   // @
	{ 0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C },   // A
	{ 0x00, 0x7F, 0x49, 0x49, 0x49, 0x36 },   // B
	{ 0x00, 0x3E, 0x41, 0x41, 0x41, 0x22 },   // C
	{ 0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C },   // D
	{ 0x00, 0x7F, 0x49, 0x49, 0x49, 0x41 },   // E
	{ 0x00, 0x7F, 0x09, 0x09, 0x09, 0x01 },   // F
	{ 0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A },   // G
	{ 0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F },   // H
	{ 0x00, 0x00, 0x41, 0x7F, 0x41, 0x00 },   // I
	{ 0x00, 0x20, 0x40, 0x41, 0x3F, 0x01 },   // J
	{ 0x00, 0x7F, 0x08, 0x14, 0x22, 0x41 },   // K
	{ 0x00, 0x7F, 0x40, 0x40, 0x40, 0x40 },   // L
	{ 0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F },   // M
	{ 0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F },   // N
	{ 0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E },   // O
	{ 0x00, 0x7F, 0x09, 0x09, 0x09, 0x06 },   // P
	{ 0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E },   // Q
	{ 0x00, 0x7F, 0x09, 0x19, 0x29, 0x46 },   // R
	{ 0x00, 0x46, 0x49, 0x49, 0x49, 0x31 },   // S
	{ 0x00, 0x01, 0x01, 0x7F, 0x01, 0x01 },   // T
	{ 0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F },   // U
	{ 0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F },   // V
	{ 0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F },   // W
	{ 0x00, 0x63, 0x14, 0x08, 0x14, 0x63 },   // X
	{ 0x00, 0x07, 0x08, 0x70, 0x08, 0x07 },   // Y
	{ 0x00, 0x61, 0x51, 0x49, 0x45, 0x43 },   // Z
	{ 0x00, 0x00, 0x7F, 0x41, 0x41, 0x00 },   // [
	{ 0x00, 0x55, 0x2A, 0x55, 0x2A, 0x55 },   // 55
	{ 0x00, 0x00, 0x41, 0x41, 0x7F, 0x00 },   // ]
	{ 0x00, 0x04, 0x02, 0x01, 0x02, 0x04 },   // ^
	{ 0x00, 0x40, 0x40, 0x40, 0x40, 0x40 },   // _
	{ 0x00, 0x00, 0x01, 0x02, 0x04, 0x00 },   // '
	{ 0x00, 0x20, 0x54, 0x54, 0x54, 0x78 },   // a
	{ 0x00, 0x7F, 0x48, 0x44, 0x44, 0x38 },   // b
	{ 0x00, 0x38, 0x44, 0x44, 0x44, 0x20 },   // c
	{ 0x00, 0x38, 0x44, 0x44, 0x48, 0x7F },   // d
	{ 0x00, 0x38, 0x54, 0x54, 0x54, 0x18 },   // e
	{ 0x00, 0x08, 0x7E, 0x09, 0x01, 0x02 },   // f
	{ 0x00, 0x18, 0xA4, 0xA4, 0xA4, 0x7C },   // g
	{ 0x00, 0x7F, 0x08, 0x04, 0x04, 0x78 },   // h
	{ 0x00, 0x00, 0x44, 0x7D, 0x40, 0x00 },   // i
	{ 0x00, 0x40, 0x80, 0x84, 0x7D, 0x00 },   // j
	{ 0x00, 0x7F, 0x10, 0x28, 0x44, 0x00 },   // k
	{ 0x00, 0x00, 0x41, 0x7F, 0x40, 0x00 },   // l
	{ 0x00, 0x7C, 0x04, 0x18, 0x04, 0x78 },   // m
	{ 0x00, 0x7C, 0x08, 0x04, 0x04, 0x78 },   // n
	{ 0x00, 0x38, 0x44, 0x44, 0x44, 0x38 },   // o
	{ 0x00, 0xFC, 0x24, 0x24, 0x24, 0x18 },   // p
	{ 0x00, 0x18, 0x24, 0x24, 0x18, 0xFC },   // q
	{ 0x00, 0x7C, 0x08, 0x04, 0x04, 0x08 },   // r
	{ 0x00, 0x48, 0x54, 0x54, 0x54, 0x20 },   // s
	{ 0x00, 0x04, 0x3F, 0x44, 0x40, 0x20 },   // t
	{ 0x00, 0x3C, 0x40, 0x40, 0x20, 0x7C },   // u
	{ 0x00, 0x1C, 0x20, 0x40, 0x20, 0x1C },   // v
	{ 0x00, 0x3C, 0x40, 0x30, 0x40, 0x3C },   // w
	{ 0x00, 0x44, 0x28, 0x10, 0x28, 0x44 },   // x
	{ 0x00, 0x1C, 0xA0, 0xA0, 0xA0, 0x7C },   // y
	{ 0x00, 0x44, 0x64, 0x54, 0x4C, 0x44 },   // z
	{ 0x14, 0x14, 0x14, 0x14, 0x14, 0x14 }    // horiz lines
};






//----------------------------------中文字符库-------------------------------------

//----------------------------------------------------------------------------------


const unsigned char chinese1[]={

0x0A,0x32,0xC2,0x32,0x1E,0x08,0x07,0xE4,0x04,0x14,0x0C,0x00,0x04,0x03,0x00,0x03,
0x08,0x04,0x03,0x00,0x03,0x04,0x08,0x00,/*"欢",0*/

0x11,0xF2,0x00,0xFE,0x82,0x41,0x00,0xFE,0x02,0x02,0xFE,0x00,0x08,0x07,0x08,0x09,
0x08,0x08,0x08,0x0F,0x08,0x09,0x09,0x00,/*"迎",1*/

0x20,0x10,0xFC,0x03,0x10,0xCF,0x04,0xF4,0x04,0x54,0x8C,0x00,0x00,0x00,0x0F,0x00,
0x02,0x01,0x08,0x0F,0x00,0x00,0x03,0x00,/*"你",2*/

0x8C,0x45,0xF5,0x55,0x55,0xEF,0x45,0x55,0x55,0x55,0x0C,0x00,0x00,0x00,0x07,0x05,
0x05,0x07,0x05,0x05,0x05,0x05,0x04,0x00,/*"霍",0*/

0x00,0x7F,0x41,0x65,0x55,0xCF,0x55,0x65,0x41,0xFF,0x00,0x00,0x04,0x03,0x00,0x07,
0x04,0x04,0x05,0x04,0x07,0x00,0x03,0x00,/*"恩",1*/

0x20,0x22,0x2A,0xB2,0x62,0xFF,0x62,0xB2,0x2A,0x22,0x20,0x00,0x02,0x02,0x01,0x00,
0x00,0x07,0x00,0x00,0x01,0x02,0x02,0x00,/*"来",2*/

0x88,0x84,0xF3,0x92,0x92,0x92,0xFE,0x92,0x92,0x92,0x82,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x07,0x00,0x00,0x00,0x00,0x00,/*"年",0*/

0x00,0x00,0x00,0xFF,0x49,0x49,0x49,0x49,0xFF,0x00,0x00,0x00,0x00,0x04,0x02,0x01,
0x00,0x00,0x04,0x04,0x07,0x00,0x00,0x00,/*"月",1*/

0x00,0x00,0xFF,0x11,0x11,0x11,0x11,0x11,0x11,0xFF,0x00,0x00,0x00,0x00,0x07,0x02,
0x02,0x02,0x02,0x02,0x02,0x07,0x00,0x00,/*"日",2*/

0xFE,0x22,0x22,0xFE,0x04,0x14,0x64,0x04,0xFF,0x04,0x04,0x00,0x03,0x01,0x01,0x03,
0x00,0x00,0x04,0x04,0x07,0x00,0x00,0x00,/*"时",0*/

0x20,0x10,0x2C,0x23,0xE0,0x20,0x20,0x23,0xEC,0x10,0x20,0x00,0x04,0x04,0x02,0x01,
0x00,0x04,0x04,0x04,0x03,0x00,0x00,0x00,/*"分",1*/

0x8A,0x6A,0xFF,0x29,0x48,0x3C,0x00,0x7F,0x00,0xC4,0x18,0x00,0x01,0x00,0x07,0x04,
0x04,0x04,0x02,0x02,0x01,0x00,0x00,0x00,/*"秒",2*/




0x89,0x72,0x00,0xC0,0x5F,0xD5,0x55,0xD5,0x55,0xDF,0x00,0x00,0x07,0x00,0x04,0x07,
0x04,0x07,0x04,0x07,0x04,0x07,0x04,0x00,/*"温",6*/

0x00,0xFE,0x0A,0x8A,0xBE,0xAA,0xAB,0xAA,0xBE,0x0A,0x0A,0x00,0x06,0x01,0x04,0x04,
0x04,0x03,0x02,0x03,0x04,0x04,0x04,0x00,/*"度",7*/


};
//****************************************************************************************************
// 写一字节
//****************************************************************************************************

void LCD_WriteByte(unsigned char dt, unsigned char command)
{
	unsigned char i; 
	sce0;            //使能LCD
	if(command==0)            //传送命令
	   dc0;
	else
	   dc1;         //传送数据
	for(i=0;i<8;i++)
	{ 
		if(dt&0x80)
			sdin1;
		else
			sdin0;
		dt=dt<<1;		
		sclk0;		
		sclk1;
	
	}	
	dc1;
    sce1;//关闭LCD
	sdin1;
}
//****************************************************************************************************
// LCD初始化
//****************************************************************************************************
void LCD_Init(void)
{
	sce1;
	res0;//产生一个让LCD复位的低电平脉冲
  	delay_ms(10);
  	res1;
	delay_ms(100);
	LCD_WriteByte(0x21,0);//使用水平寻址,进入拓展指令
    LCD_WriteByte(0x13, 0);//定液晶偏置系统 1:48
	LCD_WriteByte(0xbb,0);//设定设置Vop,相当于亮度 
    LCD_WriteByte(0x20,0);//芯片活动 使用基本指令并且水平寻址
	LCD_WriteByte(0x0c,0);//设定显示模式，正常显示
    LCD_Clear();
}

//---------------------------------------
//名称: 设置坐标函数
//参数：X：0－83 Y：0－5
//作者：huoenlai
//邮箱：1084170961@qq.com
//日期：2011/3/28  
//-----------------------------------------   
void LCD_Set_XY(unsigned char X, unsigned char Y)
{
    Y|=0x40;
    X|=0x80;
	LCD_WriteByte(Y, 0);// 列
	LCD_WriteByte(X, 0);// 行
	sce1;
} 
//****************************************************************************************************
// LCD清屏
//****************************************************************************************************

void LCD_Clear(void)
{
	unsigned char t,k;
	LCD_Set_XY(0,0);
	for(t=0;t<6;t++)
	{ 
		for(k=0;k<84;k++)
		{ 
			LCD_WriteByte(0x00,1);
				
		} 
	}
}
//****************************************************************************************************
// 写一个字符
//****************************************************************************************************
void LCD_WriteChar(unsigned char X,unsigned char Y,unsigned char c)
{
    unsigned char i,j ;
   const  unsigned char *map = &font[0][0];
    c -= 32; //变换
    map += c *( HEIGHT/8*WIDTH);
   
    for(i=0;i<HEIGHT/8;i++)
    {
        LCD_Set_XY(X, Y+i);
        for(j=0;j<WIDTH;j++)
	    LCD_WriteByte(*map++, 1);
    }
}

//****************************************************************************************************
// 写英文字符串 
//****************************************************************************************************
void LCD_WriteString_en(unsigned char X,unsigned char Y,unsigned char *s)
{
    unsigned char i=0,j=0;
    while (*s)
    {
        LCD_WriteChar(X, Y,*s++);
        X+=WIDTH;
        i++;  
        if(i>=(84/WIDTH))
		{
			X=0;
			Y+=HEIGHT;
			i=0;
			j++;
		}
		if(j>=(48/HEIGHT))
		{
		 return  ;
		}  
    }
 } 
//****************************************************************************************************
// 写一个任意数字
//****************************************************************************************************
void LCD_WriteNumber(unsigned char x,unsigned char y, unsigned long number)
{
    unsigned char num[10]={""},i,j,k;
    if(number==0)                   //number 0 时候
    {
        LCD_WriteChar(x, y,'0');
    }
    else
    {
        for(i=0;number>0;i++)
        {
            num[i]=lcd_display[number%10];//每位以字符表示
            number/=10; 
        }
        for(j=0;j<i/2;j++){k=num[j];num[j]=num[i-1-j];num[i-1-j]=k;}
        LCD_WriteString_en(x,y,num);
    }
}

//****************************************************************************************************


//****************************************************************************************************
// 写一个汉字
//****************************************************************************************************
void LCD_Write_cn(unsigned char row, unsigned char page,unsigned char c) //row:列 page:页 dd:字符
{
	unsigned char i;  	
	
	LCD_Set_XY(row, page);// 列，页 
	for(i=0; i<12;i++) 
	{
		LCD_WriteByte(chinese1[c*24+i],1); 		
	}

    LCD_Set_XY(row, page+1);// 列，页 
	for(i=12; i<24;i++) 
	{
		LCD_WriteByte(chinese1[c*24+i],1);
	}	
	
}














